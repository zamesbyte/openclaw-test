# OpenClaw 浏览器控制功能总结

> 配置与验证完成时间: 2026-02-15

---

## 一、功能概述

OpenClaw 具备完整的 **Chrome/Chromium 浏览器控制** 能力，可支持:

- 启动/停止专用托管浏览器
- 打开 URL、切换标签、导航
- 页面快照（AI/ARIA 树）
- 截图、PDF 导出
- 点击、输入、拖动、选择等交互操作
- 通过 Agent 自然语言驱动浏览器

---

## 二、已配置项

| 配置项 | 值 | 说明 |
|--------|-----|------|
| `browser.enabled` | `true` | 已启用 |
| `browser.defaultProfile` | `"openclaw"` | 默认托管模式 |
| `browser.executablePath` | `/Applications/Google Chrome.app/Contents/MacOS/Google Chrome` | Chrome 可执行路径 |

### Profile 说明

| Profile | 模式 | 用途 |
|---------|------|------|
| **openclaw** | 托管浏览器 | 专用 Chrome 实例，无需扩展，已设为默认 |
| **chrome** | 扩展中继 | 控制现有 Chrome 标签页，需安装 OpenClaw 扩展 |

---

## 三、验证结果

| # | 验证项 | 命令 | 结果 | 状态 |
|---|--------|------|------|------|
| 1 | 浏览器状态 | `openclaw browser --browser-profile openclaw status` | enabled, cdpPort 18800 | ✅ |
| 2 | 启动浏览器 | `openclaw browser --browser-profile openclaw start` | running: true | ✅ |
| 3 | 打开 URL | `openclaw browser ... open https://www.example.com` | 成功打开 | ✅ |
| 4 | 标签页列表 | `openclaw browser ... tabs` | 显示 Example Domain | ✅ |
| 5 | 页面快照 | `openclaw browser ... snapshot` | 返回 heading/paragraph/link 等元素及 ref | ✅ |
| 6 | 点击元素 | `openclaw browser ... click e6` | 成功点击 Learn more | ✅ |
| 7 | 导航 | `openclaw browser ... navigate https://www.baidu.com` | 成功导航 | ✅ |
| 8 | 截图 | `openclaw browser ... screenshot` | 输出 MEDIA:~/.openclaw/media/browser/xxx.jpg | ✅ |
| 9 | 停止 | `openclaw browser ... stop` | running: false | ✅ |

---

## 四、快速开始

```bash
# 1. 启动浏览器
openclaw browser --browser-profile openclaw start

# 2. 打开网页
openclaw browser --browser-profile openclaw open https://www.example.com

# 3. 获取快照
openclaw browser --browser-profile openclaw snapshot

# 4. 点击元素 (ref 来自 snapshot)
openclaw browser --browser-profile openclaw click e6
```

---

## 五、通过 Agent 使用

在 Discord 或飞书中向 OpenClaw 机器人发送:

- "打开 https://example.com 并告诉我页面标题"
- "在浏览器里搜索百度"
- "截取当前页面截图"

Agent 会自动调用 browser 工具完成操作。

> **重要**: 浏览器工具需要模型具备稳定的 **tool calling (函数调用)** 能力。当前使用 `qwen-max` 模型，已验证 tool calling 100% 可靠。如果切换到其他模型（如 `qwen-plus`），可能出现模型只生成文字描述而不实际调用浏览器工具的问题。详见故障修复文档。

---

## 六、故障修复记录

### 2026-02-16: 飞书消息无法触发浏览器工具调用

| 项目 | 内容 |
|------|------|
| **问题** | 通过飞书发送"打开 https://example.com 并告诉我页面标题"，agent 只回复"我将使用浏览器工具..."但未实际调用 |
| **根因** | `qwen-plus` 模型的 tool calling 能力不稳定，随着会话上下文增长（~18-19k tokens），模型生成 `stopReason: "stop"` 而非 `toolUse`，文本描述了工具调用意图但未生成实际的 function call |
| **修复** | 将模型从 `dashscope/qwen-plus` 升级为 `dashscope/qwen-max`，后者 tool calling 能力更强更稳定 |
| **验证** | 连续 3 次 CLI + Feishu channel 测试，qwen-max 均正确调用 browser 工具并返回页面标题 |

---

## 七、相关文档

| 文档 | 路径 |
|------|------|
| 操作手册 | `doc/operate/浏览器控制操作手册.md` |
| 故障修复详情 | `doc/sum/飞书浏览器工具调用故障修复.md` |
| 配置项总览 | `doc/sum/配置项.md` |
| 官方文档 | `openclaw-src/docs/tools/browser.md` |
| Chrome 扩展 | `openclaw-src/docs/tools/chrome-extension.md` |

---

> 最后更新: 2026-02-16