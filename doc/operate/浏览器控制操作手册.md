# OpenClaw 浏览器控制操作手册

> OpenClaw 可通过 CLI 或 Agent 控制 Chrome/Chromium 浏览器
> 版本: OpenClaw v2026.2.12

---

## 一、概述

OpenClaw 提供两种浏览器控制模式:

| 模式 | Profile | 说明 | 是否需要扩展 |
|------|---------|------|-------------|
| **托管浏览器** | `openclaw` | OpenClaw 启动专用 Chrome 实例，隔离于个人浏览器 | 否 |
| **扩展中继** | `chrome` | 控制现有 Chrome 标签页，需安装 OpenClaw 扩展 | 是 |

本文档主要使用 **openclaw** 托管模式（无需用户参与扩展安装）。

---

## 二、配置（已完成）

当前配置位于 `~/.openclaw/openclaw.json`:

```json
{
  "browser": {
    "enabled": true,
    "defaultProfile": "openclaw",
    "executablePath": "/Applications/Google Chrome.app/Contents/MacOS/Google Chrome"
  }
}
```

- **enabled**: 已启用
- **defaultProfile**: 默认使用 openclaw 托管模式
- **executablePath**: 使用系统已安装的 Google Chrome

---

## 三、CLI 操作

### 3.1 基本控制

```bash
# 查看状态
openclaw browser --browser-profile openclaw status

# 启动浏览器
openclaw browser --browser-profile openclaw start

# 停止浏览器
openclaw browser --browser-profile openclaw stop
```

### 3.2 标签页

```bash
# 打开 URL
openclaw browser --browser-profile openclaw open https://www.example.com

# 列出标签页
openclaw browser --browser-profile openclaw tabs

# 聚焦指定标签 (targetId)
openclaw browser --browser-profile openclaw focus <targetId>

# 关闭标签
openclaw browser --browser-profile openclaw close <targetId>
```

### 3.3 页面操作

```bash
# 导航到 URL
openclaw browser --browser-profile openclaw navigate https://www.baidu.com

# 快照 (获取页面可交互元素树)
openclaw browser --browser-profile openclaw snapshot

# 快照 (紧凑交互模式)
openclaw browser --browser-profile openclaw snapshot --interactive

# 截图
openclaw browser --browser-profile openclaw screenshot

# 全页截图
openclaw browser --browser-profile openclaw screenshot --full-page

# 导出 PDF
openclaw browser --browser-profile openclaw pdf
```

### 3.4 交互操作（基于快照 ref）

快照会输出带 `[ref=eN]` 的元素，用于后续点击/输入:

```bash
# 点击元素 (ref 来自 snapshot)
openclaw browser --browser-profile openclaw click e6

# 双击
openclaw browser --browser-profile openclaw click e6 --double

# 输入文本
openclaw browser --browser-profile openclaw type e12 "hello"

# 按回车
openclaw browser --browser-profile openclaw press Enter

# 悬停
openclaw browser --browser-profile openclaw hover e4

# 拖动
openclaw browser --browser-profile openclaw drag e10 e11

# 选择下拉项
openclaw browser --browser-profile openclaw select e9 OptionA OptionB
```

### 3.5 高级操作

```bash
# 调整视口
openclaw browser --browser-profile openclaw resize 1280 720

# 等待条件
openclaw browser --browser-profile openclaw wait --text "Done"
openclaw browser --browser-profile openclaw wait --url "**/dash"
openclaw browser --browser-profile openclaw wait --load networkidle

# 高亮元素（调试用）
openclaw browser --browser-profile openclaw highlight e12

# 控制台日志
openclaw browser --browser-profile openclaw console --level error

# 清除错误/请求
openclaw browser --browser-profile openclaw errors --clear
openclaw browser --browser-profile openclaw requests --clear
```

---

## 四、通过 Agent 控制

可通过 Discord、飞书或 CLI 向 Agent 发送消息，让 Agent 使用浏览器:

**示例消息:**
- "打开 https://example.com 并告诉我页面标题"
- "在浏览器中搜索百度"
- "截取当前页面截图"
- "点击页面上的登录按钮"

Agent 会自动调用 browser 工具，使用默认 profile (openclaw)。

---

## 五、典型工作流

### 5.1 打开网页并获取内容

```bash
openclaw browser --browser-profile openclaw start
openclaw browser --browser-profile openclaw open https://www.example.com
openclaw browser --browser-profile openclaw snapshot
# 根据 snapshot 中的 ref 进行 click/type 等操作
```

### 5.2 自动化表单填写

```bash
openclaw browser --browser-profile openclaw open https://example-form.com
openclaw browser --browser-profile openclaw snapshot --interactive
# 找到输入框 ref，如 e5
openclaw browser --browser-profile openclaw type e5 "填写内容"
openclaw browser --browser-profile openclaw click e6  # 提交按钮
```

### 5.3 截图与导出

```bash
openclaw browser --browser-profile openclaw open https://example.com
openclaw browser --browser-profile openclaw screenshot
# 输出: MEDIA:~/.openclaw/media/browser/xxx.jpg

openclaw browser --browser-profile openclaw pdf
# 保存当前页为 PDF
```

---

## 六、故障排查

| 现象 | 可能原因 | 处理 |
|------|----------|------|
| `Browser disabled` | 未启用 browser | `openclaw config set browser.enabled true` 并重启网关 |
| `profile: chrome, running: false` | 使用的是 chrome 扩展模式，需安装扩展 | 改用 `--browser-profile openclaw` |
| 点击/输入无反应 | ref 已过期（页面变更） | 重新执行 `snapshot` 获取新 ref |
| Chrome 无法启动 | executablePath 错误 | 检查路径: `ls "/Applications/Google Chrome.app/Contents/MacOS/Google Chrome"` |
| Playwright 不可用 | 部分高级功能需 Playwright | 基础 snapshot/screenshot 仍可用 |
| CDP 连接失败 | 端口被占用或网关未启动 | `openclaw gateway status` 确认，`openclaw gateway restart` 重启 |

### 常用诊断命令

```bash
# 网关状态
openclaw gateway status

# 浏览器状态
openclaw browser --browser-profile openclaw status

# 查看日志
openclaw logs --follow
```

---

## 七、安全说明

- 托管浏览器 profile 与个人 Chrome 完全隔离，不会影响日常浏览数据
- 浏览器控制服务仅监听 loopback (127.0.0.1)
- 若在 Agent 中启用 `browser.evaluate`，可执行页面内 JS，存在注入风险；默认已禁用
- 不要将含登录态的托管浏览器用于不可信任务

---

> 最后更新: 2026-02-15
